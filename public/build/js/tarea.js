!function(){!async function(){try{const a="/api/tareas?id="+r(),n=await fetch(a),o=await n.json();e=o.tareas,t()}catch(e){console.log(e)}}();let e=[];document.querySelector("#boton-tarea").addEventListener("click",(function(){n()}));const a={0:"Pendiente",1:"Completado"};function t(){if(function(){const e=document.querySelector("#listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),0===e.length){const e=document.querySelector("#listado-tareas"),a=document.createElement("P");return a.classList.add("vacio"),a.innerHTML="Aún no hay tareas",void e.appendChild(a)}e.forEach(e=>{const t=document.createElement("LI"),o=document.createElement("P");t.dataset.tareaId=e.id,t.classList.add("tarea"),o.innerHTML=""+e.nombre,o.onclick=function(){n(editar=!0,{...e})};const r=document.createElement("DIV");r.classList.add("opciones");const c=document.createElement("BUTTON");c.classList.add("btn-tarea",(""+a[e.estado]).toLowerCase()),c.textContent=a[e.estado],c.dataset.estadoTarea=e.estado,c.onclick=function(){c.classList.contains("pendiente")?tareaCompletado({...e}):c.classList.contains("completado")&&tareaPendiente({...e})};const i=document.createElement("BUTTON");i.classList.add("btn-tarea","btn-eliminar"),i.textContent="Eliminar",i.dataset.idTarea=e.id,i.onclick=function(){confirmarEliminarTarea({...e})},r.appendChild(c),r.appendChild(i),t.appendChild(o),t.appendChild(r);document.querySelector("#listado-tareas").appendChild(t)})}function n(a=!1,n={}){const i=document.createElement("DIV");i.classList.add("modal"),i.innerHTML=`\n            <form class='formulario nueva-tarea'>\n                <legend>${a?"Editar Tarea":"Añade una nueva tarea"}</legend>\n                \n                <div class="campo div-campo">\n                    <label for="tarea" class="label-tarea">Tarea:</label>\n                    <input \n                        type="text" \n                        name="tarea" \n                        id="tarea"\n                        class="input-tarea" \n                        placeholder="${a?"Editar Tarea":"Nueva tarea"}"\n                        value = "${n.nombre?n.nombre:""}"\n                        />\n                </div>\n                <div class="opciones">\n                    <input \n                        type="submit" \n                        class="enviar-nueva-tarea" \n                        value="${a?"Guardar":"Añadir"}"\n                        />\n                    <button class="cerrar-modal" type="button">Cancelar</button>\n                </div>\n            </form>\n            `,document.querySelector(".dashboard").appendChild(i),setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),i.addEventListener("click",(function(d){if(d.preventDefault(),d.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{i.remove()},200)}if(d.target.classList.contains("enviar-nueva-tarea")){const i=document.querySelector(".input-tarea").value.trim();if(""===i)return void o("El nombre de la tarea es Obligatorio","error",document.querySelector(".div-campo"));a?(n.nombre=i,c(n)):async function(a){const n=new FormData;n.append("nombre",a),n.append("proyectoId",r());try{const r="http://localhost:3001/api/tarea",c=await fetch(r,{method:"POST",body:n}),i=await c.json();if(console.log(i),o(i.mensaje,i.tipo,document.querySelector(".div-campo")),"exito"===i.tipo){document.querySelector(".modal").remove(),tareaCreada();const n={id:String(i.id),nombre:a,estado:"0",proyectoId:i.proyectoId};e=[...e,n],t()}}catch(e){console.log(e)}}(i)}}))}function o(e,a,t){const n=document.querySelector(".alertas");n&&n.remove();const o=document.createElement("DIV");o.classList.add("alertas",a),o.innerHTML=e,t.parentElement.insertBefore(o,t),setTimeout(()=>{o.remove()},1e3)}function r(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}async function c(a){const{id:n,nombre:o,estado:c,proyectoId:i}=a,d=new FormData;d.append("id",n),d.append("nombre",o),d.append("estado",c),d.append("proyectoId",r());try{const a="http://localhost:3001/api/tareas/actualizar",r=await fetch(a,{method:"POST",body:d});if("exito"===(await r.json()).respuesta.tipo){tareaActualizada();const a=document.querySelector(".modal");a&&a.remove(),e=e.map(e=>(e.id===n&&(e.estado=c,e.nombre=o),e)),t()}}catch(e){console.log(e)}}window.cambiarEstadoTarea=function(e){const a="1"===e.estado?"0":"1";e.estado=a,c(e)},window.EliminarTarea=async function(a){const{id:n,nombre:o,estado:c}=a,i=new FormData;i.append("id",n),i.append("nombre",o),i.append("estado",c),i.append("proyectoId",r());try{const n="http://localhost:3001/api/tareas/eliminar",o=await fetch(n,{method:"POST",body:i}),r=await o.json();r.resultado&&(Swal.fire("Eliminado!",r.mensaje,"success"),e=e.filter(e=>e.id!==a.id),t())}catch(e){console.log(e)}}}();